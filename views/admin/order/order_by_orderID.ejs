<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <link rel='stylesheet' href='/stylesheets/cart.css' />
    <link rel="stylesheet" href="/stylesheets/admin.css" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>

    <%- include('../partials/topbar') %>
        <%- include('../partials/sidebar') %>

            <div class="content">
                <h2>Order by Order ID</h2>
                <div>
                    <% if (Order && Order.length> 0) { %>
                        <% Order.forEach(function(itemOrder) { %>
                            <p>
                                <strong>Order ID:</strong>
                                <%= itemOrder.OrderID %><br>
                                    <strong>Customer Name:</strong>
                                    <%= itemOrder.AccountName %><br>
                                        <strong>Order Date:</strong>
                                        <%= new Date(itemOrder.OrderDate).toLocaleString('th-TH', { day: 'numeric' ,
                                            month: 'long' , year: 'numeric' , hour: 'numeric' , minute: 'numeric' }) %>
                                            <br>
                                            <strong>Status:</strong>
                                            <%= itemOrder.OrderStatus %><br>
                                                <select name="OrderStatus" id="OrderStatus">
                                                    <option value="Payment Checking">Payment Checking</option>
                                                    <option value="Payment Complete, Wait for Shipping">Payment
                                                        Complete, Wait for Shipping</option>
                                                    <option value="Shipping">Shipping</option>
                                                    <option value="Shipped">Shipped</option>
                                                </select>
                            </p>
                            <div class="column">
                                <% if (OrderDetails && OrderDetails.length> 0) { %>
                                    <% let totalQuantity=0; %>
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>ลำดับ</th>
                                                    <th></th>
                                                    <th>รายการ</th>
                                                    <th>จำนวน</th>
                                                    <th>ราคา</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% OrderDetails.forEach(function(item) { %>
                                                    <% item.forEach(function(orderDetail, index) { %>
                                                        <% totalQuantity +=orderDetail.Quantity; %>
                                                            <tr>
                                                                <td>
                                                                    <%=index+1%>
                                                                </td>
                                                                <td><img src="<%= orderDetail.Image %>" height="80"
                                                                        width="80"></td>
                                                                <td>
                                                                    <%= orderDetail.ProductName %>
                                                                </td>
                                                                <td>
                                                                    <%= orderDetail.Quantity %> ชิ้น
                                                                </td>
                                                                <td>
                                                                    <%= orderDetail.Price %> บาท
                                                                </td>
                                                            </tr>
                                                            <% }) %>
                                                                <% }) %>
                                                                    <tr>
                                                                        <td></td>
                                                                        <td></td>
                                                                        <td>รวม</td>
                                                                        <td>
                                                                            <%= totalQuantity %> ชิ้น
                                                                        </td>
                                                                        <td>
                                                                            <%= itemOrder.totalPrice %> บาท
                                                                        </td>
                                                                    </tr>
                                            </tbody>
                                        </table>
                                        <% } else { %>
                                            <p>ไม่มีคำสั่งซื้อ T-T</p>
                                            <% } %>
                            </div>
                            <br>
                            <div>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>CustomerReceipt</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <img src="/<%=itemOrder.CustomerReceipt%>" alt="Receipt Image"
                                                    height="500" width="500">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <% }) %>
                                <% } else { %>
                                    <p>ไม่มีคำสั่งซื้อ T-T</p>
                                    <% } %>
                </div>
            </div>

</body>

</html>